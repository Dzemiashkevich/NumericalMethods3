//
// Created by Dzemiashkevich Vlad on 11.11.25.
//

#ifndef GAUSSLEG_H
#define GAUSSLEG_H
#include <string>
#include <fstream>
#include <utility>
#include <cmath>

#include "GaussKristoff.h"



template <typename T>
class GaussLeg:public GaussKristoff<T> {
public:
    GaussLeg(int n) {
        T xi=0,c=0;
        this->arr= new std::pair<T,T>[n];
        switch (n) {
            case 5:
                this->arr[0] = {-0.9061798459386640,   0.2369268850561891};
                this->arr[1] = {-0.5384693101056831,   0.4786286704993665};
                this->arr[2] = {0.0,   0.5688888888888889};
                this->arr[3] = {0.5384693101056831,   0.4786286704993665};
                this->arr[4] = {0.9061798459386640,  0.2369268850561891};
                break;
            case 6:
                this->arr[0] = {0.2228466041792607,    0.458964673949963};
                this->arr[1] = {1.1889321016726230,    0.417000830772120};
                this->arr[2] = {2.9927363260593141,    0.113373382074044};
                this->arr[3] = {5.775143569104510,     0.010399197453150};
                this->arr[4] = {9.837467418382589,     0.000261017202814};
                this->arr[5] = {15.982873980601701,    8.9854790642962e-07};
                break;
            case 7:
                this->arr[0] = {0.1930436789649660,  0.4093189523872870};
                this->arr[1] = {1.0266648953391910,  0.4218312780005760};
                this->arr[2] = {2.5678767449507460,  0.1471263486575053};
                this->arr[3] = {4.9003530845264840,  0.0206335144687169};
                this->arr[4] = {8.1821534445628600,  0.0010740101432807};
                this->arr[5] = {12.734180291797828,  0.00001586546434856};
                this->arr[6] = {19.395727862262544,  0.00000003170315480};
                break;
            case 8:
                this->arr[0] = {0.1702796323051010,  0.3691885882082020};
                this->arr[1] = {0.9037017767993800,  0.4187867808143440};
                this->arr[2] = {2.2510866298661310,  0.1757949866371770};
                this->arr[3] = {4.2667001702876590,  0.03334349226121570};
                this->arr[4] = {7.0459054023934680,  0.00279453623522567};
                this->arr[5] = {10.758516010180996,  0.00009076508771606};
                this->arr[6] = {15.740678641278005,  0.00000084857467228};
                this->arr[7] = {22.863131736889263,  0.00000000104800117};
                break;
            case 9:
                this->arr[0] = {0.1523222277318082,  0.3361264217979620};
                this->arr[1] = {0.8072200227422550,  0.4112139794633110};
                this->arr[2] = {2.0051351556193480,  0.1992875241073110};
                this->arr[3] = {3.7834739733312320,  0.0474605627656510};
                this->arr[4] = {6.2049567778766120,  0.0055996266107946};
                this->arr[5] = {9.3729852516875760,  0.00030524976709321};
                this->arr[6] = {13.466236911092094,  0.00000659212302676};
                this->arr[7] = {18.833597788991696,  0.00000004110769333};
                this->arr[8] = {26.374071890927375,  0.00000000003290874};
                break;
        }
    }
    GaussLeg(int n, const std::string& Filename):GaussKristoff<T>::GaussKristoff(n, Filename) {}

    static T answer(int k, std::function<T(T)> f) {
    GaussLeg<T> g(k);
    T Integral=0;
    for (int i=1; i<=k; i++) {
        Integral+=f(g.arr[i-1].first)*g.arr[i-1].second;
    }
    return Integral;
}
    };




#endif //GAUSSLEG_H
