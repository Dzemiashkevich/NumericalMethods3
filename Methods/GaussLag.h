//
// Created by Dzemiashkevich Vlad on 12.11.25.
//

#ifndef GAUSSLAG_H
#define GAUSSLAG_H
#include "GaussKristoff.h"

template <typename T>
class GaussLag:public GaussKristoff<T> {
    GaussLag(int n): GaussKristoff<T>() {
        T xi = 0, c = 0;
        this->arr = new std::pair<T, T>[n];
        switch (n) {
            case 2:
                xi = 0.585786;
                c = 0.853553;
                this->arr[0] = std::pair<T, T>(xi, c);
                xi = 3.414214;
                c = 0.146447;
                this->arr[1] = std::pair<T, T>(xi, c);
                break;
            case 3:
                xi = 0.415775;
                c = 0.711093;
                this->arr[0] = std::pair<T, T>(xi, c);
                xi = 2.294280;
                c = 0.278518;
                this->arr[1] = std::pair<T, T>(xi, c);
                xi = 6.289945;
                c = 0.0103893;
                this->arr[2] = std::pair<T, T>(xi, c);
                break;
            case 4:
                xi = 0.322548;
                c = 0.603154;
                this->arr[0] = std::pair<T, T>(xi, c);
                xi = 1.745761;
                c = 0.357419;
                this->arr[1] = std::pair<T, T>(xi, c);
                xi = 4.536620;
                c = 0.0388879;
                this->arr[2] = std::pair<T, T>(xi, c);
                xi = 9.395071;
                c = 0.000539295;
                this->arr[3] = std::pair<T, T>(xi, c);
                break;

            case 5:
                this->arr[0] = {0.2635603197181409,   0.5217556105828086};
                this->arr[1] = {1.4134030591065168,   0.3986668110831761};
                this->arr[2] = {3.5964257710407220,   0.0759424496817076};
                this->arr[3] = {7.0858100058588376,   0.00361175867992205};
                this->arr[4] = {12.6408008442757820,  0.000023369972385776};
                break;
            case 6:
                this->arr[0] = {0.2228466041792607,    0.458964673949963};
                this->arr[1] = {1.1889321016726230,    0.417000830772120};
                this->arr[2] = {2.9927363260593141,    0.113373382074044};
                this->arr[3] = {5.775143569104510,     0.010399197453150};
                this->arr[4] = {9.837467418382589,     0.000261017202814};
                this->arr[5] = {15.982873980601701,    8.9854790642962e-07};
                break;
            case 7:
                this->arr[0] = {0.1930436789649660,  0.4093189523872870};
                this->arr[1] = {1.0266648953391910,  0.4218312780005760};
                this->arr[2] = {2.5678767449507460,  0.1471263486575053};
                this->arr[3] = {4.9003530845264840,  0.0206335144687169};
                this->arr[4] = {8.1821534445628600,  0.0010740101432807};
                this->arr[5] = {12.734180291797828,  0.00001586546434856};
                this->arr[6] = {19.395727862262544,  0.00000003170315480};
                break;
            case 8:
                this->arr[0] = {0.1702796323051010,  0.3691885882082020};
                this->arr[1] = {0.9037017767993800,  0.4187867808143440};
                this->arr[2] = {2.2510866298661310,  0.1757949866371770};
                this->arr[3] = {4.2667001702876590,  0.03334349226121570};
                this->arr[4] = {7.0459054023934680,  0.00279453623522567};
                this->arr[5] = {10.758516010180996,  0.00009076508771606};
                this->arr[6] = {15.740678641278005,  0.00000084857467228};
                this->arr[7] = {22.863131736889263,  0.00000000104800117};
                break;
            case 9:
                this->arr[0] = {0.1523222277318082,  0.3361264217979620};
                this->arr[1] = {0.8072200227422550,  0.4112139794633110};
                this->arr[2] = {2.0051351556193480,  0.1992875241073110};
                this->arr[3] = {3.7834739733312320,  0.0474605627656510};
                this->arr[4] = {6.2049567778766120,  0.0055996266107946};
                this->arr[5] = {9.3729852516875760,  0.00030524976709321};
                this->arr[6] = {13.466236911092094,  0.00000659212302676};
                this->arr[7] = {18.833597788991696,  0.00000004110769333};
                this->arr[8] = {26.374071890927375,  0.00000000003290874};
                break;
            case 50:
                this->arr[0]  = {2.86305183423860e-02,   7.14047261198225e-02};
this->arr[1]  = {1.50882935650504e-01,   1.47148607343403e-01};
this->arr[2]  = {3.70948781534847e-01,   1.85671627874842e-01};
this->arr[3]  = {6.89040220623085e-01,   1.84385382580968e-01};
this->arr[4]  = {1.10547314618067e+00,   1.54201675747122e-01};
this->arr[5]  = {1.62063555313130e+00,   1.11685894669487e-01};
this->arr[6]  = {2.23498706822953e+00,   7.10528855876251e-02};
this->arr[7]  = {2.94906010402662e+00,   4.00202769002714e-02};
this->arr[8]  = {3.76347024670647e+00,   2.00506231243972e-02};
this->arr[9]  = {4.67891820044401e+00,   8.96085119824300e-03};
this->arr[10] = {5.69619170876184e+00,   3.57811243429390e-03};
this->arr[11] = {6.81616937725997e+00,   8.18143356938000e-04};
this->arr[12] = {8.03982646800097e+00,   4.08030222864800e-04};
this->arr[13] = {9.36823930740330e+00,   1.16528831668100e-04};
this->arr[14] = {1.08025921803214e+01,   2.97417048868000e-05};
this->arr[15] = {1.23441945711481e+01,   6.77784252720000e-06};
this->arr[16] = {1.39944898515823e+01,   1.37747949580000e-06};
this->arr[17] = {1.57550638182627e+01,   2.49288618300000e-07};
this->arr[18] = {1.76276532150530e+01,   4.01035435000000e-08};
this->arr[19] = {1.96141552716596e+01,   5.72333170000000e-09};
this->arr[20] = {2.17166407367004e+01,   7.22943400000000e-10};
this->arr[21] = {2.39373759920418e+01,   8.06171000000000e-11};
this->arr[22] = {2.62788514633707e+01,   7.91330000000000e-12};
this->arr[23] = {2.87438008236685e+01,   6.81600000000000e-13};
this->arr[24] = {3.13352204661471e+01,   5.13000000000000e-14};
this->arr[25] = {3.40564082748382e+01,   3.30000000000000e-15};
this->arr[26] = {3.69109846848183e+01,   1.90000000000000e-16};
this->arr[27] = {3.99029403168676e+01,   9.00000000000000e-18};
this->arr[28] = {4.30366861300031e+01,   4.00000000000000e-19};
this->arr[29] = {4.63171092202790e+01,   1.40000000000000e-20};
this->arr[30] = {4.97496361983027e+01,   4.00000000000000e-22};
this->arr[31] = {5.33403274134448e+01,   1.00000000000000e-23};
this->arr[32] = {5.70959869863704e+01,   2.00000000000000e-25};
this->arr[33] = {6.10243183973478e+01,   3.00000000000000e-27};
this->arr[34] = {6.51341189971051e+01,   3.00000000000000e-29};
this->arr[35] = {6.94355248827633e+01,   2.00000000000000e-31};
this->arr[36] = {7.39404153133349e+01,   9.00000000000000e-34};
this->arr[37] = {7.86628270079441e+01,   3.00000000000000e-36};
this->arr[38] = {8.36195402013297e+01,   8.00000000000000e-39};
this->arr[39] = {8.88308961800048e+01,   1.00000000000000e-40};
this->arr[40] = {9.43229340071970e+01,   1.00000000000000e-42};
this->arr[41] = {1.00130973399031e+02,   8.00000000000000e-45};
this->arr[42] = {1.06303619590953e+02,   3.00000000000000e-47};
this->arr[43] = {1.12908388162573e+02,   9.00000000000000e-50};
this->arr[44] = {1.20044860823987e+02,   2.00000000000000e-52};
this->arr[45] = {1.27869148563315e+02,   2.00000000000000e-54};
this->arr[46] = {1.36668999652347e+02,   1.00000000000000e-56};
this->arr[47] = {1.47004873651513e+02,   4.00000000000000e-59};
this->arr[48] = {1.60132981908004e+02,   1.00000000000000e-61};
this->arr[49] = {1.78170503154242e+02,   1.00000000000000e-63};
break;
        }

    }

    GaussLag(int n, const std::string& Filename):GaussKristoff<T>::GaussKristoff(n, Filename) {}
public:
   static T answer(int k, std::function<T(T)> f) {
       GaussLag<T> g(k);
        T Integral=0;
        for (int i=1; i<=k; i++) {
            Integral+=f(g.arr[i-1].first)*g.arr[i-1].second;
        }
        return Integral;
    }
};



#endif //GAUSSLAG_H
